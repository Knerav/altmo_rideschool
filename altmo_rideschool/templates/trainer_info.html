<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trainer Information</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <style>
        /* Add your custom styles here */
        body {
            font-family: Arial, sans-serif;
            background-color: #f7f7f7;
        }

        h1 {
            text-align: center;
            margin-bottom: 20px;
        }

        table {
            width: 100%;
            background-color: #fff;
            border: 1px solid #ddd; /* Add border to the table */
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
            white-space: pre-wrap; /* Add line divisions */
        }

        /* Adjust the width for the "Training Location" column */
        th:nth-child(10),
        td:nth-child(10) {
            width: 30%; /* Adjust the width as needed */
        }

        thead {
            background-color: #343a40; /* Bootstrap dark background color */
            color: #fff;
        }

        th {
            font-weight: bold;
            border-right: 1px solid #ddd; /* Add right border to table headers */
        }

        tbody tr:nth-child(even) {
            background-color: #f2f2f2; /* Alternate row background color */
        }
    </style>
</head>
<body>
    {% include 'navbar.html' %}
    <br>
    <br>
    <br>
    <h1>Trainer Information</h1>

    <table class="table table-striped">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Email</th>
                <th>Contact</th>
                <th>Training Location</th>
                <th>Trainer Status</th>
                <th>Gender</th>
                <th>Aadhar No</th>
                <th>Registered Date</th>
                <th>Training Completion Date</th>
                <th>Organisation</th>
                <th>Trainer Code</th>
                <th>Update</th>
            </tr>
        </thead>
        <tbody>
            {% for trainer in trainers %}
            <tr>
                <td>{{ trainer['trainer_id'] }}</td>
                <td>{{ trainer['trainer_name'] }}</td>
                <td>{{ trainer['trainer_email'] }}</td>
                <td>{{ trainer['trainer_contact'] }}</td>
                <!-- Display current training location for each trainer 
                <td> <label for="location-select-{{ trainer[0] }}">Current Location: {{ trainer[4] }}</label><select class="location-select" id="location-select-{{ trainer[0] }}">
                    {% for location in training_locations %}
                        <option value="{{ location }}">{{ location }}</option>
                    {% endfor %}
                </select></td>
            -->
            <td>
                <label for="location-select-{{ trainer['trainer_id'] }}">Current Location: {{ trainer['training_location'] }}</label>
                <select class="location-select" id="location-select-{{ trainer['trainer_id'] }}">
                    {% for location in training_locations %}
                        <option value="{{ location['training_location_id'] }}">{{ location['training_location'] }}</option>
                    {% endfor %}
                </select>
            </td>
            
               <!-- <td>
                   
                    <label for="location-select-{{ trainer['trainer_id'] }}">Current Location: {{ trainer['training_location'] }}</label>


                    <select class="location-select" id="location-select-{{ trainer['trainer_id'] }}">
                        {% for location_id, location in training_locations %}
                            <option value="{{ location_id }}">{{ location }}</option>
                        {% endfor %}
                    </select>
                </td>-->
                <td>
                    <select class="status-select" name="trainer_status" trainer-id="{{ trainer['trainer_id'] }}" data-initial-status="{{ trainer['trainer_status'] }}">
                        <option value="{{ trainer['trainer_status'] }}" selected>{{ trainer['trainer_status'] }}</option>
                        <option value="CERTIFIED">CERTIFIED</option>
                        <option value="NOT CERTIFIED">NOT CERTIFIED</option>
                    </select>
                </td>
                <td>{{ trainer['trainer_gender'] }}</td>
                <td>{{ trainer['trainer_aadhar_no'] }}</td>
                <td>{{ trainer['trainer_created_at'] }}</td>
                <td>{{ trainer['trainer_training_completion_date'] }}</td>
                <td>{{ trainer['organisation_name'] }}</td>
                <td>{{ trainer['trainer_code'] }}</td>
                <td>
                    <button class="update-button btn btn-primary" trainer-id="{{ trainer['trainer_id'] }}">Update</button>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <!-- Add your existing JavaScript here -->

    <script>
        $(document).ready(function () {
    // Event listener for individual update buttons
    $(".update-button").click(function () {
        var trainerId = $(this).attr("trainer-id");
        var newStatus = $(this).closest("tr").find(".status-select option:selected").val();
        var newLocationId = $(this).closest("tr").find(".location-select option:selected").val();
        //var newLocation = $(this).closest("tr").find(".location-select option:selected").val();
        updateTrainerStatus(trainerId, newStatus, newLocationId);
    });
});

// Function to update individual trainer status
function updateTrainerStatus(trainerId, newStatus, newLocationId) {
    // Your existing AJAX logic for individual update
    // ...

    // Example AJAX request:
    $.ajax({
        url: '/trainer_update_status',
        type: 'POST',
        contentType: 'application/json',
        data: JSON.stringify({ trainerId: trainerId, newStatus: newStatus, newLocationId: newLocationId }),
        success: function (response) {
            // Handle success
            console.log(response);
        },
        error: function () {
            // Handle error
            console.error("Error updating trainer status");
        },
    });
}

    </script>
</body>
</html>
