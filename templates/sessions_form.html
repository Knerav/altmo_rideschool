

<!DOCTYPE html>
<html>
<head>
  <title> Participant Session Form</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <style>
    /* CSS styling for the form */
    body {
      font-family: Arial, sans-serif;
    }

    .container {
      max-width: 500px;
      margin: 0 auto;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    .container h1 {
      text-align: center;
      margin-bottom: 20px;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      font-weight: bold;
      margin-bottom: 5px;
    }

    
.form-group input,
.form-group textarea,
.form-group select {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 3px;
}

    .form-group .date-time-wrapper {
      display: flex;
      align-items: center;
    }

    .form-group .date-time-wrapper .date-input,
    .form-group .date-time-wrapper .time-input {
      flex: 1;
      margin-right: 10px;
    }

    .form-group .date-input[type="date"]::-webkit-inner-spin-button,
    .form-group .date-input[type="date"]::-webkit-outer-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    .form-group .time-input[type="time"]::-webkit-inner-spin-button,
    .form-group .time-input[type="time"]::-webkit-outer-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    .form-group input[type="file"] {
      padding: 6px 10px;
    }

    .form-group button {
      padding: 10px 20px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 3px;
      cursor: pointer;
    }

    .form-group button:hover {
      background-color: #45a049;
    }

    .form-group select#trainer-name {
  width: 100%;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 3px;
}
.form-group select#participant-name {
  width: 100%;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 3px;
}
.form-group select#hours-trained {
  width: 100%;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 3px;
}
  
  </style>
</head>
<body>
    
  <div class="container">
    <h1>Participants Session Form</h1>
    <form id="training-session-form" method="POST" action="/submit_form" enctype="multipart/form-data">
        <div class="form-group">
        <label for="trainer-name">Trainer Name:</label>
    <select name="trainer-name" id="trainer_name" required>
        <option value="">Select Trainer</option>
    </select>
    <input type="hidden" name="training_location_id" id="trainer_training_location_id">
</div>
<div class="form-group">

    <label for="participant-name">Participant Name:</label>
    <select name="participant-name" id="participant_name" class="form-control">

        <option value="">Select Participant</option>
    </select>
    <input type="hidden" name="training_location_id" id="participant_training_location_id">
</div>

    <div class="form-group">
        <label for="scheduled-datetime">Scheduled Date and Time:</label>
        <div class="date-time-wrapper">
          <input type="datetime-local" id="scheduled-datetime" name="scheduled-datetime" required>
        </div>
      </div>

      <div class="form-group">
        <label for="actual-datetime">Actual Date and Time:</label>
        <div class="date-time-wrapper">
          <input type="datetime-local" id="actual-datetime" name="actual-datetime" required>
        </div>
      </div>

      <div class="form-group">
        <label for="hours-trained">Hours Trained:</label>
        <select id="hours-trained" name="hours-trained" required>
          <option value="0.5">30 Minutes</option>
          <option value="1">1 Hour</option>
          <option value="1.5">1 Hour 30 Minutes</option>
          <option value="2">2 Hour's</option>
        </select>
      </div>
      

      <div class="form-group">
        <label for="session-picture">Picture:</label>
        <input type="file" id="session-picture" name="session-picture" accept="image/*" required>
      </div>

      <div class="form-group">
        <label for="session-video">Video:</label>
        <input type="file" id="session-video" name="session-video" accept="video/*" required>
      </div>

      <div class="form-group">
        <label for="session-description">Description:</label>
        <textarea id="session-description" name="session-description" rows="4" required></textarea>
      </div>

      <div class="form-group">
        <button type="submit">Submit</button>
      </div>

</form>
</div>
<script>
    // Fetch trainer names from the backend and populate the trainer select element
    $.get('/trainers', function (data) {
        var trainerSelect = $('#trainer_name');
        data.forEach(function (trainer) {
            var option = $('<option></option>').attr('value', trainer.trainer_id).text(trainer.trainer_name);
            trainerSelect.append(option);
        });
    });
    // When a trainer is selected, fetch the corresponding training_location_id and update the hidden input
    // Also fetch the participants for the selected trainer and update the participant select element
    $('#trainer_name').on('change', function () {
        var trainerId = $(this).val();
        $.get('/trainer/' + trainerId, function (data) {
            $('#trainer_training_location_id').val(data.training_location_id);

            // Fetch the participants for the selected trainer and training_location_id
            $.get('/participants/' + trainerId, function (participantsData) {
                var participantSelect = $('#participant_name');
                participantSelect.empty(); // Clear previous options

                participantsData.forEach(function (participant) {
                    if (participant.participant_status !== "COMPLETED") {
                        var option = $('<option></option>').attr('value', participant.participant_name).text(participant.participant_name);
                        participantSelect.append(option);
                    }
                });
            });
        });
    });

    // When a participant is selected, fetch the corresponding training_location_id and update the hidden input
    $('#participant_name').on('change', function () {
        var participantId = $(this).val();
        $.get('/participant/' + participantId, function (data) {
            $('#participant_training_location_id').val(data.training_location_id);
        });
    });
</script>
</body>
</html>
